

<script src="<?= BASE_ASSET; ?>/js/jquery.hotkeys.js"></script>

<script type="text/javascript">

//This page is a result of an autogenerated content made by running test.html with firefox.

function domo(){

 

   // Binding keys

   $('*').bind('keydown', 'Ctrl+e', function assets() {

      $('#btn_edit').trigger('click');

       return false;

   });



   $('*').bind('keydown', 'Ctrl+x', function assets() {

      $('#btn_back').trigger('click');

       return false;

   });

    

}





jQuery(document).ready(domo);

</script>

<!-- Content Header (Page header) -->

<section class="content-header">

   <h1>

      Vérification du Proforma      <small><?//= cclang('detail', ['Proforma']); ?> </small>

   </h1>

   <ol class="breadcrumb">

      <li><a href="#"><i class="fa fa-dashboard"></i> Accueil</a></li>

      <li class=""><a  href="<?= site_url('administrator/project_proforma'); ?>">Vйrification du Proforma</a></li>

      <li class="active"><?//= cclang('detail'); ?></li>

   </ol>

</section>

<!-- Main content -->

<section class="content">

  <?php

   $project=$this->uri->segment(4);

   $client=$this->uri->segment(5);

    /* $projet = $project_proforma->project_proforma_devis_id;
     $client = $project_proforma->project_proforma_client_id;*/

     //echo $project."/".$client; ?> 

   <div class="row" >

     

      <div class="col-md-12">

         <div class="box box-warning">

            <div class="box-body ">



               <!-- Widget: user widget style 1 -->

               <div class="box box-widget widget-user-2">

                  <!-- Add the bg color to the header using any of the bg-* classes -->

                 <!--  <div class="widget-user-header ">

                    

                     <div class="widget-user-image">

                        <img class="img-circle" src="<?//= BASE_ASSET; ?>/img/view.png" alt="User Avatar">

                     </div>

                   

                     <h3 class="widget-user-username">Project Proforma</h3>

                     <h5 class="widget-user-desc">Detail Project Proforma</h5>

                     <hr>

                  </div> -->



                 

                  <div class="form-horizontal" name="form_project_proforma" id="form_project_proforma" >

                     <?= form_open('', [

                            'name'    => 'form_list_proforma', 

                            'class'   => 'form-horizontal', 

                            'id'      => 'form_list_proforma', 

                            'enctype' => 'multipart/form-data', 

                            'method'  => 'POST'

                            ]); ?>

                <div class="content">

                

                 <div class="row">


                                      <?php

$this->db->select('*');
$this->db->from('pos_ibi_clients as c');
$this->db->join('pos_store_2_ibi_devis as d', 'c.ID_CLIENT = d.REF_CLIENT_DEVIS');
$this->db->where('ID_DEVIS',$this->uri->segment(4));

$query = $this->db->get();
if ($query->num_rows() > 0)  //Ensure that there is at least one result 
{
   foreach ($query->result() as $row)  //Iterate through results
   {
      $nom = $row->NOM_CLIENT;
      $prenom = $row->PRENOM_CLIENT;
      $address = $row->ADRESSE_CLIENT;
      $email = $row->EMAIL_CLIENT;
      $telephone = $row->TEL_CLIENT;
      $nif = $row->STATE_CLIENT;
      //$created_by = $order[ 'order' ][0][ 'AUTHOR' ];
     
   }
}
?> 

                   <div class="col-md-6">

                     <div class="breadcumb pull-left">
                       <span>Client : </span>
        <div style="margin: 0px 2px 0px 0px;">
          <span class="bold">● <?php echo $nom.' '.$prenom;?></span>
        </div> 
        <div style="margin: 0px 2px 0px 0px;">
          <span>● Bujumbura-BURUNDI</span>
        </div>
        
        <div>
          <span style="margin: 0px 2px 0px 0px;">● Tel : <?php echo $telephone?></span>
          <span style="margin: 0px 2px 0px 0px;">● Email : <?php echo $email?></span>
        </div>
        <div>
          <span style="margin: 0px 2px 0px 0px;">● NIF : <?php echo $nif?></span>
        </div>
                     </div>
                     
                   </div>

                   <div class="col-md-6">

                    <div class="pull-right"><b>Date :</b><?php echo date("d-m-Y").' '.'<br/>'; ?></div>

                    
                        

                       <!--  <br/><input type="text" class="form-control col-sm-8 pull-right" name="reference" id="reference" placeholder="Ajouter n°  de reference" value=""> -->
                       
                    
                   </div>

            
                   
                 </div>

          <div class="form-group ">  

                   

                     <table border="0" style="width: 100%" class="table table_bordered">

                        <thead>

                        <tr>
                          
                          <th class="marge_">DESIGNATION</th>
                          <th class="marge_">REFERENCE</th>
                          <th class="marge_ text-center">QTE STOCK</th>
                          <th class="marge_ text-center">P.V</th>
                          <th colspan="" class="marge_ text-center">QTE DEVIS</th><th class="marge_ text-center">P.U</th><th class="marge_ text-center">P.T</th>
                        </tr>
                      </thead>
                       <?php

                  

                     ?>

                       <tbody>
                        <!--  <input type="text" class="form-control" name="reference" id="reference" placeholder="Ajouter n°  de reference" value=""><br/> -->

                         <input type="text" class="form-control" name="devi_id" id="devi_id" placeholder="" value="" style="display:none;">

                        <input type="text" class="form-control" name="client_id" id="client_id" placeholder="" value="" style="display:none;">

                        <input type="text" class="form-control" name="proforma_reference" id="proforma_reference" placeholder="Ajouter n°  de reference" value="" required><i class="required">*</i><br/>

                         <input type="text" class="form-control" name="project_proforma_title" id="project_proforma_title" placeholder="Ajouter le titre du proforma" value="" style="display:;"><i class="required">*</i>

                          <input type="hidden" class="form-control" name="proforma_code" id="proforma_code" placeholder="Ajouter le titre du proforma" value="<?//= _ent( $proforma_number); ?>" style="display:;">

                         <tr>
                           <td class="td_width">

                           

                            <input type="hidden" class="form-control" name="garantie" id="garantie" placeholder="Garantie" value="">
                            <input type="hidden" class="form-control" name="validite" id="validite" placeholder="Validite" value="">
                            <input type="hidden" class="form-control" name="paiement" id="paiement" placeholder="Conditions depaiement" value="">

                             <input type="hidden" class="form-control" name="verification" placeholder="" value="">

                            <input type="hidden" class="form-control" name="design[]" id="design" placeholder="Design" value="">chaise</td>
                           <td colspan="" class="marge"><input type="hidden" class="form-control" name="reference[]" id="reference" placeholder="Reference" value="">ref 12</td>

                           <td class="text-center">90</td>

                           <td class="text-center"><?php /*echo number_format($request->project_articles_prix_vente_pondere,0," "," ");*/ ?></td>

                           <?php 

                          // if ($qty_project_produits > $stock_theorique) {

                           ?>
                           <td class="marge text-center quantite_"><input type="hidden" class="form-control" name="quantite[]" id="quantite" placeholder="Quantite" value="">&nbsp;&nbsp;<span class="fa fa-exclamation-triangle" aria-hidden="true" title="" style="color:#ed7926;">
                            </td>

                            <td class="marge text-center quantite_"><input type="hidden" class="form-control" name="quantite[]" id="quantite" placeholder="Quantite" value="">10
                          &nbsp;&nbsp;<span class="fa fa-check-square" aria-hidden="true" title="" style="color:#26edd2;"></td>
                      

                            <td class="marge text-center"><input type="number" class="form-control unit_price" name="unit_price[]" id="unit_price" idprix="" prixRest="" placeholder="Prix de vente" min="" value=18></td>

                           <td class="marge text-center tot_price"><input type="text" class="form-control" name="total_price[]" readonly id="total_price" placeholder="Prix de vente total" value=""></td>
                         
                           

                          
                         </tr>

                        

                  <tr>
                    <td colspan="2"><input type="text" class="form-control" name="design1" id="design1" placeholder="Completer les cablages, Accessoires,..." value="Cablage, Accessoires, Test & Main d'oeuvre"></td>
                    <td colspan="2"><input type="text" class="form-control" name="reference1" id="reference1" placeholder="Completer les references" value="SMART CARE"></td>
                    <td><input type="text" class="form-control quantite1_" name="quantite1" id="quantite1" placeholder="Quantite" value=""></td>
                    <td><input type="text" class="form-control unit_price1_" name="unit_price1" id="unit_price1" placeholder="Prix unitaire" value=""></td>
                    <td><input type="text" class="form-control total_price1_" name="total_price1" id="total_price1" readonly placeholder="Prix total" value=""></td>

                  </tr>
                    <tr>
                    <td colspan="2"><input type="text" class="form-control" name="design1" id="design1" placeholder="Completer les cablages, Accessoires,..." value="Cablage, Accessoires, Test & Main d'oeuvre"></td>
                    <td colspan="2"><input type="text" class="form-control" name="reference1" id="reference1" placeholder="Completer les references" value="SMART CARE"></td>
                    <td><input type="text" class="form-control quantite1_" name="quantite1" id="quantite1" placeholder="Quantite" value=""></td>
                    <td><input type="text" class="form-control unit_price1_" name="unit_price1" id="unit_price1" placeholder="Prix unitaire" value=""></td>
                    <td><input type="text" class="form-control total_price1_" name="total_price1" id="total_price1" readonly placeholder="Prix total" value=""></td>

                  </tr>

         
              
                     <tr>
                    <td colspan="2"><input type="text" class="form-control" name="design1" id="design1" placeholder="Completer les cablages, Accessoires,..." value="Cablage, Accessoires, Test & Main d'oeuvre"></td>
                    <td colspan="2"><input type="text" class="form-control" name="reference1" id="reference1" placeholder="Completer les references" value="SMART CARE"></td>
                    <td><input type="text" class="form-control quantite1_" name="quantite1" id="quantite1" placeholder="Quantite" value="0"></td>
                    <td><input type="text" class="form-control unit_price1_" name="unit_price1" id="unit_price1" placeholder="Prix unitaire" value="0"></td>
                    <td><input type="text" class="form-control total_price1_" name="total_price1" id="total_price1" readonly placeholder="Prix total" value="0"></td>

                  </tr>
         
                      <tr><th colspan="4" class="text-center">MAIN D'OEUVRES</th><th colspan="2" class="">TERMES/CONDITIONS</th><th colspan="2" class="">TOTAL</th></tr>

                      <tr>
                        <td colspan="7" style="border: 0px solid;">
                          
                        <div class="row">
                        <div class="col-md-12">
                          <div class="col-xs-6 col-md-6 pull-left table-bordered" id="tab" style="border: 0px solid;">

                            <table class="table table-bordered">
                          <thead>
                            <tr>
                            <th>Nombre</th>
                            <th>Categorie</th>
                            <th>Nbre jrs</th>
                            <th>P.U</th>
                            <th>P.T</th>


                          </tr>
                          </thead>
                          <tbody>

                            <tr>
                              <td></td>
                              <td></td>
                              <td></td>
                              <td></td>
                              <td></td>
                            </tr>

                            

                        <tr><td colspan="3">TOT GEN.</td><td colspan="2" class="text-right"></td></tr>

                          </tbody>
                          

                        </table>
                            
                          </div>
                          <div class="col-xs-6 col-md-6 table-bordered" id="tab" style="border: 0px solid;">

                           

                            <table class="table table-bordered">

                             <tr>


                           <td colspan="">Garantie(mois)</td>
                            <td><input type="number" class="form-control" name="garantie" id="garantie" placeholder="Garantie" value="<?php echo '24'; ?>"></td>

                            <td width="150">Total HTVA</td>
                            <td width="150"></td>
                            
                          </tr>
                          <tr>
                        <td colspan="">Validité de la proforma(jours)</td>
                            <td><input type="number" class="form-control" name="validite" id="validite" placeholder="Validite" value="<?php
                             echo '25'; ?>">
                            </td>
                         <td width="150">TVA (18%)</td>
                         <td class="" width="150"></td>

                         <!-- <td class="" width="150"><?php //echo '<span class="tva">'.number_format(round($TVA),0," "," ").'</span> FBU' ; ?></td> -->

                      </tr>
                      <tr>
                        <td colspan="">Conditions de paiement(%)</td>
                            <td><input type="text" class="form-control" name="paiement" id="paiement" placeholder="Conditions depaiement" value="<?php
                             echo '100'; ?>">
                            </td>
                        
                         <td class="td_dio" width="150">GRAND TOTAL</td>
                         <td class="td_dio" width="150">
                          <input type="hidden" class="form-control tot_gen_value" name="grand_total" id="grand_total" placeholder="Paiement" value="">
                        </td>

                      </tr>

                      <tr>
                        <td colspan="">Delais de livraison</td>
                            <td colspan=""><input type="hidden" class="form-control" name="livraison" id="livraison" placeholder="Conditions depaiement" value="">
                          </td>

                      </tr>

                      <tr>

                        <td colspan="">Periode d'installation</td>
                            <td colspan=""><input type="hidden" class="form-control" name="installation" id="installation" placeholder="Periode d'installation" value="">
                          </td>
                        
                      </tr>

                      <tr>

                        <td colspan="">Temps de test</td>
                            <td colspan=""><input type="hidden" class="form-control" name="test" id="test" placeholder="Temps de test" value="">
                          </td>
                        
                      </tr>
                            
                          </div>
                        </table>
                        </div>
                          
                      </div>
                        </td>
                        
                      </tr>

                      <?php 

                            
                        
                 ?>



                      </tbody>
                    
                   </table>
                 

                                  
        </div>
                  
                    <br>

                    <div class="message"></div>

                   <div class="row-fluid col-md-7">

                           <!-- <button class="btn btn-flat btn-primary btn_save btn_action" id="btn_save" data-stype='stay' title="<?= cclang('save_button'); ?> (Ctrl+s)">

                            <i class="fa fa-save" ></i> <?= cclang('save_button'); ?>

                            </button> -->

                            
                            <button class="btn btn-flat btn-info btn_save btn_action btn_save_back" type="submit" id="btn_save" data-stype='back' title="save and back to the list (Ctrl+d)">

                            <i class="fa fa-check" ></i> Confirmer

                            </button>

                            <a class="btn btn-flat btn-default btn_action" id="btn_cancel" title="<?= cclang('cancel_button'); ?> (Ctrl+x)">

                            <i class="fa fa-undo" ></i> Retour

                            </a>

                            <span class="loading loading-hide">

                            <img src="<?= BASE_ASSET; ?>/img/loading-spin-primary.svg"> 

                            <i><?= cclang('loading_saving_data'); ?></i>

                            </span>

                        </div>

                      </div>

                     <?= form_close(); ?>

                  </div>

               </div>

            </div>

            <!--/box body -->

         </div>

         <!--/box -->



      </div>

   </div>

</section>

<!-- /.content -->

<script>

    $(document).ready(function(){

     /* qte=$('.quantite1_').val();

        price=$('.unit_price1_').val();
        prix=qte*price;

        $('.total_price1_').val(prix);*/

         

      $('#btn_cancel').click(function(){

        swal({

            title: "<?= cclang('are_you_sure'); ?>",

            text: "<?= cclang('data_to_be_deleted_can_not_be_restored'); ?>",

            type: "warning",

            showCancelButton: true,

            confirmButtonColor: "#DD6B55",

            confirmButtonText: "Yes!",

            cancelButtonText: "No!",

            closeOnConfirm: true,

            closeOnCancel: true

          },

          function(isConfirm){

            if (isConfirm) {

              window.location.href = BASE_URL + 'administrator/project_proforma/add_new_proforma';

            }

          });

    

        return false;

      }); /*end btn cancel*/



      // $(document).on('keyup','#unit_price',function(){
      //   var unit_price = $('#unit_price').val();
      //   // var total_price = $('#total_price').val();
      //   var quantite = $('#quantite').val();

      //   $.ajax({
      //     url: BASE_URL +'/administrator/project_proforma/save_unit_price',
      //     type: 'POST',
      //     data:{unit_price:unit_price,quantite:quantite},
      //     dataType:'json',
      //     success: function(data){

      //       console.log(data.msg);

      //       $('#total_price').val(data.msg);

      //     }
      //   });
      // });

      // $(document).on('keyup','unit_price1',function(){
      //   alert();
      // });
    

      $('.btn_save').click(function(){

        avoid_multi_click_btn('btn_save', 15000);

        $('.message').fadeOut();

    //alert('ok');

    /*swal({

            title: "Vous voulez confirmer ?",

            text: "",

            type: "warning",

            showCancelButton: true,

            confirmButtonColor: "#DD6B55",

            confirmButtonText: "Oui",

            cancelButtonText: "Non",

            closeOnConfirm: true,

            closeOnCancel: true

          },

          function(isConfirm){

            if (isConfirm) {*/

            

        var form_project = $('#form_list_proforma');

        var data_post = form_project.serializeArray();

        var save_type = $(this).attr('data-stype');



        data_post.push({name: 'save_type', value: save_type});

    

        $('.loading').show();

    

        $.ajax({

          url: BASE_URL + '/administrator/project_proforma/save_list_proforma',

          type: 'POST',

          dataType: 'json',

          data: data_post,

        })




        .done(function(res) {

          if(res.success) {

            

            if (save_type == 'back') {

              window.location.href = res.redirect;

              return;

            }

    

            $('.message').printMessage({message : res.message});

            $('.message').fadeIn();

            resetForm();

            $('.chosen option').prop('selected', false).trigger('chosen:updated');

                

          } else {

            $('.message').printMessage({message : res.message, type : 'warning'});

          }

    

        })



        .fail(function() {

          $('.message').printMessage({message : 'Error save data', type : 'warning'});

        })

        .always(function() {

          $('.loading').hide();

          $('html, body').animate({ scrollTop: $(document).height() }, 2000);

        });

     /* }

   });*/
    

        return false;



      }); /*end btn save*/

      

     $('.unit_price').on('keyup',function(){


        var id = $(this).attr('idprix');

        var quantite=0;
        var prixRest=$(this).attr('prixRest');
        var price=$(this).val();
        var total_htva=0;
        
        //alert(prixRest);
        /*if ((prixRest.length) <=(price.length)) {*/
        /*if(prixRest < price){
          $('#unit_price'+id+'').val(price);
        }else{
          $('#unit_price'+id+'').val(prixRest);
        }*/
        
        

        var pt=0;

        tot_htva=parseFloat($('.tot_HTVA').html());

        var old_tot_prix=$(this).parent().parent().children('.tot_price').children('#total_price').val();

        var price=$(this).val();

        //alert(tot_htva);

        quantite=$(this).parent().parent().children('.quantite_').children('#quantite').val();

        price=$(this).val();

        pt=quantite*price;

        if(pt!==null && pt>0)
        {
          $(this).parent().parent().children('.tot_price').children('#total_price').val(pt);

          var tot_new=pt-old_tot_prix;

          $('.tot_HTVA').html(tot_new+tot_htva);

          var calcul_tva=parseFloat($('.tot_HTVA').html());

          $('.tva').html(Math.round((calcul_tva*18)/100));

          var calcul_tot_gen=parseFloat($('.tot_HTVA').html())+parseFloat($('.tva').html());

          $('.grandTotal').html(Math.round(calcul_tot_gen));

           $('#grand_total').val(Math.round(calcul_tot_gen));

          //alert(tot_new);


          
        }

        else 
        {
          $(this).parent().parent().children('.tot_price').children('#total_price').val('0');
        }

/*}

else{
  $('#unit_price'+id+'').val(prixRest);
}*/
 }); 


     

   $('body').on('change','.unit_price',function(){


        var id = $(this).attr('idprix');

        var quantite=0;
        var prixRest=$(this).attr('prixRest');
        var price=$(this).val();
       /* if(prixRest < price){
          $('#unit_price'+id+'').val(price);
        }else{
          $('#unit_price'+id+'').val(prixRest);
        }*/
        
        

        var pt=0;

        quantite=$(this).parent().parent().children('.quantite_').children('#quantite').val();

        price=$(this).val();

        pt=quantite*price;

        if(pt!==null && pt>0)
        {
          $(this).parent().parent().children('.tot_price').children('#total_price').val(pt);
        }

        else 
        {
          $(this).parent().parent().children('.tot_price').children('#total_price').val('0');
        }


 });


  $('body').on('keyup','#unit_price1',function(){

  //alert('ok');

        var qte=0;

        var prix=0;

        var total_htva=0;

        var tva=0;

        var tot_htva=0;

        var tot_gen=0;

        var tot_gen_value=0;

        qte=$('.quantite1_').val();

        tot_htva=parseFloat($('.tot_HTVA').html());

        tva=parseFloat($('.tva').html());

        tot_gen=parseFloat($('.grandTotal').html());

        tot_gen_value=parseFloat($('#grand_total').val());

        price=$(this).val();

        prix=qte*price;

        var old_tot_price=$('.total_price1_').val();

        var tot_php=tot_htva-old_tot_price;


        if(prix!==null && prix>0)
        {

         

          $('.total_price1_').val(prix);



          $('.tot_HTVA').html(tot_php+parseFloat($('.total_price1_').val()));

          var tva_php=$('.tot_HTVA').html(tot_php+parseFloat($('.total_price1_').val()));

          var calcul_tva=parseFloat($('.tot_HTVA').html());

          $('.tva').html(Math.round((calcul_tva*18)/100));

          var calcul_tot_gen=parseFloat($('.tot_HTVA').html())+parseFloat($('.tva').html());

          $('.grandTotal').html(Math.round(calcul_tot_gen));

           $('#grand_total').val(Math.round(calcul_tot_gen));



        }

        else 
        {
          $('.total_price1_').val('0');
        }

 });
    

$('body').on('keyup','#quantite1',function(){

  //alert('ok');

        var qte=0;

        var tva=0;

        var tot_gen=0;

        var tot_gen_value=0;

        var prix=0;

        qte=$('.quantite1_').val();

        price=$('.unit_price1_').val();

        tot_htva=parseFloat($('.tot_HTVA').html());

        tva=parseFloat($('.tva').html());

        tot_gen=parseFloat($('.grandTotal').html());

        tot_gen_value=parseFloat($('#grand_total').val());

        //alert(tot_gen_value);

        prix=qte*price;

        var old_tot_price=$('.total_price1_').val();

        var tot_php=tot_htva-old_tot_price;

        if(prix!==null && prix>0)
        {
          $('.total_price1_').val(prix);

          $('.tot_HTVA').html(tot_php+parseFloat($('.total_price1_').val()));

          var calcul_tva=parseFloat($('.tot_HTVA').html());

          $('.tva').html(Math.round((calcul_tva*18)/100));

          var calcul_tot_gen=parseFloat($('.tot_HTVA').html())+parseFloat($('.tva').html());

          $('.grandTotal').html(Math.round(calcul_tot_gen));

           $('#grand_total').val(Math.round(calcul_tot_gen));

          

        }

        else 
        {
          $('.total_price1_').val('0');
        }

 });


 $('body').on('change','#unit_price1',function(){

  //alert('ok');

        var qte=0;

        var prix=0;

        var total_htva=0;

        var tva=0;

        var tot_htva=0;

        var tot_gen=0;

        var tot_gen_value=0;

        qte=$('.quantite1_').val();

        tot_htva=parseFloat($('.tot_HTVA').html());

        tva=parseFloat($('.tva').html());

        tot_gen=parseFloat($('.grandTotal').html());

        tot_gen_value=parseFloat($('#grand_total').val());

        price=$(this).val();

        prix=qte*price;

        var old_tot_price=$('.total_price1_').val();

        var tot_php=tot_htva-old_tot_price;


        if(prix!==null && prix>0)
        {

         

          $('.total_price1_').val(prix);



          $('.tot_HTVA').html(tot_php+parseFloat($('.total_price1_').val()));

          var tva_php=$('.tot_HTVA').html(tot_php+parseFloat($('.total_price1_').val()));

          var calcul_tva=parseFloat($('.tot_HTVA').html());

          $('.tva').html(Math.round((calcul_tva*18)/100));

          var calcul_tot_gen=parseFloat($('.tot_HTVA').html())+parseFloat($('.tva').html());

          $('.grandTotal').html(Math.round(calcul_tot_gen));

           $('#grand_total').val(Math.round(calcul_tot_gen));



        }

        else 
        {
          $('.total_price1_').val('0');
        }

 });


    

$('body').on('change','#quantite1',function(){

  //alert('ok');

        var qte=0;

        var tva=0;

        var tot_gen=0;

        var tot_gen_value=0;

        var prix=0;

        qte=$('.quantite1_').val();

        price=$('.unit_price1_').val();

        tot_htva=parseFloat($('.tot_HTVA').html());

        tva=parseFloat($('.tva').html());

        tot_gen=parseFloat($('.grandTotal').html());

        tot_gen_value=parseFloat($('#grand_total').val());

        //alert(tot_gen_value);

        prix=qte*price;

        var old_tot_price=$('.total_price1_').val();

        var tot_php=tot_htva-old_tot_price;

        if(prix!==null && prix>0)
        {
          $('.total_price1_').val(prix);

          $('.tot_HTVA').html(tot_php+parseFloat($('.total_price1_').val()));

          var calcul_tva=parseFloat($('.tot_HTVA').html());

          $('.tva').html(Math.round((calcul_tva*18)/100));

          var calcul_tot_gen=parseFloat($('.tot_HTVA').html())+parseFloat($('.tva').html());

          $('.grandTotal').html(Math.round(calcul_tot_gen));

           $('#grand_total').val(Math.round(calcul_tot_gen));

          

        }

        else 
        {
          $('.total_price1_').val('0');
        }

 });
    

    

    }); /*end doc ready*/

function avoid_multi_click_btn(btn_id, period)
  {
      $('#'+btn_id).attr('disabled', true);

      var my_interval = setInterval(function(){

        $('#'+btn_id).attr('disabled', false);

        clearInterval(my_interval);

      }, period);
  }

</script>